%% bare/jrnl.tex
%% V1.4b
%% 2015/08/26
%% by Michael  Shell
%% see http://www.michaelshell.org/
%% for current contact information.
%%
%% This is a skeleton file demonstrating the use of IEEEtran.cls
%% (requires IEEEtran.cls version 1.8b or later) with an IEEE
%% journal paper.
%%
%% Support sites:
%% http://www.michaelshell.org/tex/ieeetran/
%% http://www.ctan.org/pkg/ieeetran
%% and
%% http://www.ieee.org/

%%*************************************************************************
%% Legal Notice:
%% This code is offered as-is without any warranty either expressed or
%% implied; without even the implied warranty of MERCHANTABILITY or
%% FITNESS FOR A PARTICULAR PURPOSE! 
%% User assumes all risk.
%% In no event shall the IEEE or any contributor to this code be liable for
%% any damages or losses, including, but not limited to, incidental,
%% consequential, or any other damages, resulting from the use or misuse
%% of any information contained here.
%%
%% All comments are the opinions of their respective authors and are not
%% necessarily endorsed by the IEEE.
%%
%% This work is distributed under the LaTeX Project Public License (LPPL)
%% ( http://www.latex-project.org/ ) version 1.3, and may be freely used,
%% distributed and modified. A copy of the LPPL, version 1.3, is included
%% in the base LaTeX documentation of all distributions of LaTeX released
%% 2003/12/01 or later.
%% Retain all contribution notices and credits.
%% ** Modified files should be clearly indicated as such, including  **
%% ** renaming them and changing author support contact information. **
%%*************************************************************************


% *** Authors should verify (and, if needed, correct) their LaTeX system  ***
% *** with the testflow diagnostic prior to trusting their LaTeX platform ***
% *** with production work. The IEEE's font choices and paper sizes can   ***
% *** trigger bugs that do not appear when using other class files.       ***                          ***
% The testflow support page is at:
% http://www.michaelshell.org/tex/testflow/



\documentclass[journal]{IEEEtran}
%
% If IEEEtran.cls has not been installed into the LaTeX system files,
% manually specify the path to it like:
% \documentclass[journal]{../sty/IEEEtran}





% Some very useful LaTeX packages include:
% (uncomment the ones you want to load)


% *** MISC UTILITY PACKAGES ***
%
%\usepackage{ifpdf}
% Heiko Oberdiek's ifpdf.sty is very useful if you need conditional
% compilation based on whether the output is pdf or dvi.
% usage:
% \ifpdf
%   % pdf code
% \else
%   % dvi code
% \fi
% The latest version of ifpdf.sty can be obtained from:
% http://www.ctan.org/pkg/ifpdf
% Also, note that IEEEtran.cls V1.7 and later provides a builtin
% \ifCLASSINFOpdf conditional that works the same way.
% When switching from latex to pdflatex and vice-versa, the compiler may
% have to be run twice to clear warning/error messages.






% *** CITATION PACKAGES ***
%
%\usepackage{cite}
% cite.sty was written by Donald Arseneau
% V1.6 and later of IEEEtran pre-defines the format of the cite.sty package
% \cite{} output to follow that of the IEEE. Loading the cite package will
% result in citation numbers being automatically sorted and properly
% "compressed/ranged". e.g., [1], [9], [2], [7], [5], [6] without using
% cite.sty will become [1], [2], [5]--[7], [9] using cite.sty. cite.sty's
% \cite will automatically add leading space, if needed. Use cite.sty's
% noadjust option (cite.sty V3.8 and later) if you want to turn this off
% such as if a citation ever needs to be enclosed in parenthesis.
% cite.sty is already installed on most LaTeX systems. Be sure and use
% version 5.0 (2009-03-20) and later if using hyperref.sty.
% The latest version can be obtained at:
% http://www.ctan.org/pkg/cite
% The documentation is contained in the cite.sty file itself.






% *** GRAPHICS RELATED PACKAGES ***
%
\ifCLASSINFOpdf
  % \usepackage[pdftex]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../pdf/}{../jpeg/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.pdf,.jpeg,.png}
\else
  % or other class option (dvipsone, dvipdf, if not using dvips). graphicx
  % will default to the driver specified in the system graphics.cfg if no
  % driver is specified.
  % \usepackage[dvips]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../eps/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.eps}
\fi
% graphicx was written by David Carlisle and Sebastian Rahtz. It is
% required if you want graphics, photos, etc. graphicx.sty is already
% installed on most LaTeX systems. The latest version and documentation
% can be obtained at: 
% http://www.ctan.org/pkg/graphicx
% Another good source of documentation is "Using Imported Graphics in
% LaTeX2e" by Keith Reckdahl which can be found at:
% http://www.ctan.org/pkg/epslatex
%
% latex, and pdflatex in dvi mode, support graphics in encapsulated
% postscript (.eps) format. pdflatex in pdf mode supports graphics
% in .pdf, .jpeg, .png and .mps (metapost) formats. Users should ensure
% that all non-photo figures use a vector format (.eps, .pdf, .mps) and
% not a bitmapped formats (.jpeg, .png). The IEEE frowns on bitmapped formats
% which can result in "jaggedy"/blurry rendering of lines and letters as
% well as large increases in file sizes.
%
% You can find documentation about the pdfTeX application at:
% http://www.tug.org/applications/pdftex





% *** MATH PACKAGES ***
%
%\usepackage{amsmath}
% A popular package from the American Mathematical Society that provides
% many useful and powerful commands for dealing with mathematics.
%
% Note that the amsmath package sets \interdisplaylinepenalty to 10000
% thus preventing page breaks from occurring within multiline equations. Use:
%\interdisplaylinepenalty=2500
% after loading amsmath to restore such page breaks as IEEEtran.cls normally
% does. amsmath.sty is already installed on most LaTeX systems. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/amsmath





% *** SPECIALIZED LIST PACKAGES ***
%
%\usepackage{algorithmic}
% algorithmic.sty was written by Peter Williams and Rogerio Brito.
% This package provides an algorithmic environment fo describing algorithms.
% You can use the algorithmic environment in-text or within a figure
% environment to provide for a floating algorithm. Do NOT use the algorithm
% floating environment provided by algorithm.sty (by the same authors) or
% algorithm2e.sty (by Christophe Fiorio) as the IEEE does not use dedicated
% algorithm float types and packages that provide these will not provide
% correct IEEE style captions. The latest version and documentation of
% algorithmic.sty can be obtained at:
% http://www.ctan.org/pkg/algorithms
% Also of interest may be the (relatively newer and more customizable)
% algorithmicx.sty package by Szasz Janos:
% http://www.ctan.org/pkg/algorithmicx




% *** ALIGNMENT PACKAGES ***
%
%\usepackage{array}
% Frank Mittelbach's and David Carlisle's array.sty patches and improves
% the standard LaTeX2e array and tabular environments to provide better
% appearance and additional user controls. As the default LaTeX2e table
% generation code is lacking to the point of almost being broken with
% respect to the quality of the end results, all users are strongly
% advised to use an enhanced (at the very least that provided by array.sty)
% set of table tools. array.sty is already installed on most systems. The
% latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/array


% IEEEtran contains the IEEEeqnarray family of commands that can be used to
% generate multiline equations as well as matrices, tables, etc., of high
% quality.




% *** SUBFIGURE PACKAGES ***
%\ifCLASSOPTIONcompsoc
%  \usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
%\else
%  \usepackage[caption=false,font=footnotesize]{subfig}
%\fi
% subfig.sty, written by Steven Douglas Cochran, is the modern replacement
% for subfigure.sty, the latter of which is no longer maintained and is
% incompatible with some LaTeX packages including fixltx2e. However,
% subfig.sty requires and automatically loads Axel Sommerfeldt's caption.sty
% which will override IEEEtran.cls' handling of captions and this will result
% in non-IEEE style figure/table captions. To prevent this problem, be sure
% and invoke subfig.sty's "caption=false" package option (available since
% subfig.sty version 1.3, 2005/06/28) as this is will preserve IEEEtran.cls
% handling of captions.
% Note that the Computer Society format requires a larger sans serif font
% than the serif footnote size font used in traditional IEEE formatting
% and thus the need to invoke different subfig.sty package options depending
% on whether compsoc mode has been enabled.
%
% The latest version and documentation of subfig.sty can be obtained at:
% http://www.ctan.org/pkg/subfig




% *** FLOAT PACKAGES ***
%
%\usepackage{fixltx2e}
% fixltx2e, the successor to the earlier fix2col.sty, was written by
% Frank Mittelbach and David Carlisle. This package corrects a few problems
% in the LaTeX2e kernel, the most notable of which is that in current
% LaTeX2e releases, the ordering of single and double column floats is not
% guaranteed to be preserved. Thus, an unpatched LaTeX2e can allow a
% single column figure to be placed prior to an earlier double column
% figure.
% Be aware that LaTeX2e kernels dated 2015 and later have fixltx2e.sty's
% corrections already built into the system in which case a warning will
% be issued if an attempt is made to load fixltx2e.sty as it is no longer
% needed.
% The latest version and documentation can be found at:
% http://www.ctan.org/pkg/fixltx2e


%\usepackage{stfloats}
% stfloats.sty was written by Sigitas Tolusis. This package gives LaTeX2e
% the ability to do double column floats at the bottom of the page as well
% as the top. (e.g., "\begin{figure*}[!b]" is not normally possible in
% LaTeX2e). It also provides a command:
%\fnbelowfloat
% to enable the placement of footnotes below bottom floats (the standard
% LaTeX2e kernel puts them above bottom floats). This is an invasive package
% which rewrites many portions of the LaTeX2e float routines. It may not work
% with other packages that modify the LaTeX2e float routines. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/stfloats
% Do not use the stfloats baselinefloat ability as the IEEE does not allow
% \baselineskip to stretch. Authors submitting work to the IEEE should note
% that the IEEE rarely uses double column equations and that authors should try
% to avoid such use. Do not be tempted to use the cuted.sty or midfloat.sty
% packages (also by Sigitas Tolusis) as the IEEE does not format its papers in
% such ways.
% Do not attempt to use stfloats with fixltx2e as they are incompatible.
% Instead, use Morten Hogholm'a dblfloatfix which combines the features
% of both fixltx2e and stfloats:
%
% \usepackage{dblfloatfix}
% The latest version can be found at:
% http://www.ctan.org/pkg/dblfloatfix




%\ifCLASSOPTIONcaptionsoff
%  \usepackage[nomarkers]{endfloat}
% \let\MYoriglatexcaption\caption
% \renewcommand{\caption}[2][\relax]{\MYoriglatexcaption[#2]{#2}}
%\fi
% endfloat.sty was written by James Darrell McCauley, Jeff Goldberg and 
% Axel Sommerfeldt. This package may be useful when used in conjunction with 
% IEEEtran.cls'  captionsoff option. Some IEEE journals/societies require that
% submissions have lists of figures/tables at the end of the paper and that
% figures/tables without any captions are placed on a page by themselves at
% the end of the document. If needed, the draftcls IEEEtran class option or
% \CLASSINPUTbaselinestretch interface can be used to increase the line
% spacing as well. Be sure and use the nomarkers option of endfloat to
% prevent endfloat from "marking" where the figures would have been placed
% in the text. The two hack lines of code above are a slight modification of
% that suggested by in the endfloat docs (section 8.4.1) to ensure that
% the full captions always appear in the list of figures/tables - even if
% the user used the short optional argument of \caption[]{}.
% IEEE papers do not typically make use of \caption[]'s optional argument,
% so this should not be an issue. A similar trick can be used to disable
% captions of packages such as subfig.sty that lack options to turn off
% the subcaptions:
% For subfig.sty:
% \let\MYorigsubfloat\subfloat
% \renewcommand{\subfloat}[2][\relax]{\MYorigsubfloat[]{#2}}
% However, the above trick will not work if both optional arguments of
% the \subfloat command are used. Furthermore, there needs to be a
% description of each subfigure *somewhere* and endfloat does not add
% subfigure captions to its list of figures. Thus, the best approach is to
% avoid the use of subfigure captions (many IEEE journals avoid them anyway)
% and instead reference/explain all the subfigures within the main caption.
% The latest version of endfloat.sty and its documentation can obtained at:
% http://www.ctan.org/pkg/endfloat
%
% The IEEEtran \ifCLASSOPTIONcaptionsoff conditional can also be used
% later in the document, say, to conditionally put the References on a 
% page by themselves.




% *** PDF, URL AND HYPERLINK PACKAGES ***
%
%\usepackage{url}
% url.sty was written by Donald Arseneau. It provides better support for
% handling and breaking URLs. url.sty is already installed on most LaTeX
% systems. The latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/url
% Basically, \url{my/url/here}.




% *** Do not adjust lengths that control margins, column widths, etc. ***
% *** Do not use packages that alter fonts (such as pslatex).         ***
% There should be no need to do such things with IEEEtran.cls V1.6 and later.
% (Unless specifically asked to do so by the journal or conference you plan
% to submit to, of course. )


% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}

%------ Additions by Daniel
%for Lorem 
\usepackage{lipsum}
%for ABC lists 
% from https://tex.stackexchange.com/questions/129951/enumerate-tag-using-the-alphabet-instead-of-numbers
\usepackage{enumitem}

%Code Syntax 
\input{includes/TamarinLstListing}

%Commands for usign Tamarin reservered words etc in a consistent way
\usepackage{TamarinKeywords}

%For BIG letters C and M
\usepackage{ dsfont }
% for todos
\usepackage{todonotes}
%-------- End Additions by Daniel

\begin{document}
%
% paper title
% Titles are generally capitalized except for words such as a, an, and, as,
% at, but, by, for, in, nor, of, on, or, the, to and up, which are usually
% not capitalized unless they are the first or last word of the title.
% Linebreaks \\ can be used within to get better formatting as desired.
% Do not put math or special symbols in the title.
\title{Inference Attacks on Property Preserving Encryption in the Symbolic Model}
%
% author names and IEEE memberships
% note positions of commas and nonbreaking spaces ( ~ ) LaTeX will not break
% a structure at a ~ so this keeps an author's name from being broken across
% two lines.
% use \thanks{} to gain access to the first footnote area
% a separate \thanks must be used for each paragraph as LaTeX2e's \thanks
% was not built to handle multiple paragraphs
%

% \author{Michael~Shell,~\IEEEmembership{Member,~IEEE,}
%         John~Doe,~\IEEEmembership{Fellow,~OSA,}
%         and~Jane~Doe,~\IEEEmembership{Life~Fellow,~IEEE}% <-this % stops a space
% \thanks{M. Shell was with the Department
% of Electrical and Computer Engineering, Georgia Institute of Technology, Atlanta,
% GA, 30332 USA e-mail: (see http://www.michaelshell.org/contact.html).}% <-this % stops a space
% \thanks{J. Doe and J. Doe are with Anonymous University.}% <-this % stops a space
% \thanks{Manuscript received April 19, 2005; revised August 26, 2015.}}
\author{Daniel~Becker}
% note the % following the last \IEEEmembership and also \thanks - 
% these prevent an unwanted space from occurring between the last author name
% and the end of the author line. i.e., if you had this:
% 
% \author{....lastname \thanks{...} \thanks{...} }
%                     ^------------^------------^----Do not want these spaces!
%
% a space would be appended to the last name and could cause every name on that
% line to be shifted left slightly. This is one of those "LaTeX things". For
% instance, "\textbf{A} \textbf{B}" will typeset as "A B" not "AB". To get
% "AB" then you have to do: "\textbf{A}\textbf{B}"
% \thanks is no different in this regard, so shield the last } of each \thanks
% that ends a line with a % and do not let a space in before the next \thanks.
% Spaces after \IEEEmembership other than the last one are OK (and needed) as
% you are supposed to have spaces between the names. For what it is worth,
% this is a minor point as most people would not even notice if the said evil
% space somehow managed to creep in.



% The paper headers
%\markboth{Journal of \LaTeX\ Class Files,~Vol.~14, No.~8, August~2015}%
%{Shell \MakeLowercase{\textit{et al.}}: Bare Demo of IEEEtran.cls for IEEE Journals}
% The only time the second header will appear is for the odd numbered pages
% after the title page when using the twoside option.
% 
% *** Note that you probably will NOT want to include the author's ***
% *** name in the headers of peer review papers.                   ***
% You can use \ifCLASSOPTIONpeerreview for conditional compilation here if
% you desire.




% If you want to put a publisher's ID mark on the page you can do it like
% this:
%\IEEEpubid{0000--0000/00\$00.00~\copyright~2015 IEEE}
% Remember, if you use this you must call \IEEEpubidadjcol in the second
% column for its text to clear the IEEEpubid mark.



% use for special paper notices
%\IEEEspecialpapernotice{(Invited Paper)}




% make the title area
\maketitle

% As a general rule, do not put math, special symbols or citations
% in the abstract or keywords.
\begin{abstract}
\todo[inline]{(100 words) Show	Conjecture	Verify	Propose Achieves	Benefits}
\cite{InfrenceAttacks}
\end{abstract}

% Note that keywords are not normally used for peerreview papers.
\begin{IEEEkeywords}
Some keywords.
\end{IEEEkeywords}






% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peerreview papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle

% \section{META}
% Using Tamarin can we model a property preserving encryption protocol and verify it in the symbolical model against a well specified threat profile. Can we get \tamarin{} to find the previously known attacks/limitations.

% \begin{itemize}
% \item Approach
% \item Select a suitable protocol
%   \item 	One that is implemnted somewhere rathr than just specified in a paper
%   \item 	One that has published attacks/limiations
%   \item 	One that is not too complex.
% \item Model evolution
%   \item 		Secure Channel between client and server
%   \item 		Deliberately reveal everything stored to sysadmin "Honest but Curious"
%   \item 		Prove secure with RND
%   \item 		Test with DET
%   \item 		Test with OPE
%   \item 		Test with Search
% \end{itemize}



% Candidate Protocol 1
% 	OPE from CryptDB, "attacked" in \cite{InfrenceAttacks}

% Candidate Protocol 2
% 	\textbf{DTE from CryptDB, "attacked" in \cite{InfrenceAttacks}}


% Notes:
% Distinction between a scheme and a protocol.. are we attacking a protocol or a scheme plus a psuedo protocol that we've invented.
% Insight: Can we use oracles in the attack to cover the gaps in Tamarin. 
% Challenge is the threshold level.
% DET is probably simplest.

% 	Paper approach
% \begin{enumerate}
% \item 		Write Methodology
% \item 		Review Canditate Protocols
% \item 		Write Threat model text
% \item 		Write Tamarin Model for protocol execution
% \item 		Write model for threate model
% \item 		Write results
% \item 		Rewrite methodology
% \item 		Write introduction
% \item 		Write conclusions
% \item 		Write Abstract
% \item 		Edit
% \end{enumerate}


\section{Introduction and motivation}
\todo[inline]{2000 words}

\subsection{Background}
\todo[inline]{500 words}
\begin{itemize}
\item Preliminaries
\item 	Symbolic modelling and tamarin
\item Protocol
\item 	Background/History
\item 	How it works
\item 	Existing attacks and limitations
\item Threat Model
\item Translation to Tamarin
\item 	Protocol Execution
\item 	Threat Model as Lemmas
\end{itemize}

\subsection{Motivation}
\todo[inline]{500 words}
The real-world effectiveness of inference attacks depends on the availability of a well-correlated data-set. Work on the design of inference attacks /cite{Ismal2012} shows that it is possible to recover information about encrypted data-sets and queries from data leakage combined with auxiliary data-sets such as statistical census data. Work in /cite{InfrenceAttacks} shows that information can be recovered for data encrypted with Deterministic Encryption (DET) and Order Preserving Encryption (OPE) with a high degree of accuracy; 60\%+ for DET and 80\%+ for OPE in the case of certain attribute of medical records. 
This work explores initial directions in how symbolical verification can be extended to detect potential inference attacks.

Inference attacks are one of the oldest attack models. Consider a simple letter substitution cipher (Caesar's cipher) where D replaces with A, E replaces B etc. An attacker can generate a letter frequency histogram from an auxiliary data-set such as previous messages or even a general corpus. For the English language message the attacker could assume that the most used letter in the enciphered message corresponds to the letter 'e'. The attacker can continue in this manner using individual letter frequency or include more sophisticate analysis of two-letter frequencies for example.
In a more modern context we can consider a database column encrypted with Deterministic Encryption (DET) i.e an encryption that always produces the same encrypted text for a given plain-text. This form of encryption forms part of many Encrypted database systems such as CryptDB /cite{CryptDB}, /cite{cipherbase}, /cite{Bellare2007}. 

DET encryption is a useful construct for building encrypted databases as it performs well, does not suffer from significant message expansion, and  permits searching. DET encryption is know to leak equality information /cite{SOK} but /cite{InfrenceAttacks} shows that with a suitable auxiliary data-set the individual values are recoverable via inference. Consider a DET encrypted database column representing the sex of patients who stayed at a hospital; A simple histogram of the two possible values might show a 55\%/45\% split. An attacker could infer that the 55\% represents females as auxiliary data-sets show more of the patients will be female/cite{InfrenceAttacks} than male. This fact can then be leveraged to infer other attributes; i.e certain disease types affect females more than males; more males are born that females and females have a longer life expectancy. These publicly available statistics are an auxillary dataset that an attacker can freely use. 

The number of possible values in the dataset affects the success of such attacks. For example the recovery rate of the patients \textit{ Age} was only 10\% in 83\% of the hospitals /cite{InfrenceAttacks}; this was due to the large number of values and that multiple values have similar frequencies.

The security of such a system then relies on the \_absence\_ of a strongly correlated auxiliary data-set and on the size and distribution of the values.
\subsection{Contribution}
\todo[inline]{1000 words}
\subsection{Related Work}
\todo[inline]{500 words}
\subsection{Threat Model}
This paper considers a threat model where an adversary has access to an encrypted data set (legitimately as in an honest-but-curious security model or illegitimately in a a breech scenario). The attacker also has access to an auxiliary dataset that is structured in the same manner as the encrypted dataset i.e. same data-types and number of distinct values. This auxiliary dataset could be in the form of a publicly available dataset or it could be the result of a side-channel attack \cite{Kocher96}.\todo[inline]{Examples of side channel attacks.}
\todo[inline]{[Adversarial Goals 100 words
	Adversarial information 500
	Auxiliary Dataset 500}
\subsection{Auxiliary Dataset}
\todo[inline]{What it is, why they are important, how easy they are to get etc.
	How well correlated is the aux column with the unencrypted values}
\subsection{Symbolic Verification and Tamarin}
\todo[inline]{500 words}
\subsection{Property Preserving Encryption}
\todo[inline]{250 words}
\subsection{Inference}
\todo[inline]{500 words}
\todo[inline]{O: Islam, Kuzu and Kantrcioglu \cite{Ismal2012} showed that inference attacks are useful , summarise contribution.}
\section{Methodology}
\subsection{Implementing Inference Attack in a Symbolical Model with \tamarin{}}
\todo[inline]{1500 words}
We use an Observational Equivalence approach to compare an evenly distributed auxiliary dataset (i.e. semantically secure and immune to inference) with a target dataset that \tamarin{} can generate by inserting values. In the case of an evenly distributed auxiliary dataset the there is nothing to infer from regardless of the distribution of the target dataset If two protocols are observational equivalence an attacker can not reason about the differences and Tamarin can prove that an adversary can not distinguish between two systems and we can prove that the data is secure.


An attacker has access to an encrypted dataset \enc{} over the message space \encSpace{} and plaintext auxiliary dataset \aux{} over the message space \auxSpace. Using a frequency analysis approach as described in \cite{InfrenceAttacks} an attacker will assign plaintext values to to each of the encrypted values by rank ordering the dataset histograms. i.e the most common value in \enc{}\ is declared to be the most common value in \aux{} etc. 
The general approach is:
\begin{enumerate}[label=(\Alph*)]
\item \textbf{Protocol Model} The protocol is modelled with \tamarin{} state transition rules. \tamarin{} uses these state transition rules to move between states. Security and Execution properties are encoded in the form of \texttt{lemmas} using first order propositional logic. 
\begin{enumerate}
	\item \LSecurity{Confidentiality}: - the adversary never knows the encrypted values. If this lemma is validated the proof fails.
    \item \LExecution{Encryption and Decryption}: Lemma to ensure that has the protocol executed correctly. A protocol that never executes remains secure and can give false positive results.
	\item \LExecution{Growth}: The dataset of encrypted values grows correctly as new values are added and that the set of counters increments correctly as the population grows; these counters model the distribution in the protected data.
\end{enumerate}

\item \textbf{The Auxiliary Population \aux{} over \auxSpace}: The auxiliary population and its histogram data is encoded into the model using \tamarin{} multisets as \tamarin{} currently has no direct support for counters. The distribution of the auxiliary population is varied and injected in to the model using a script external to \tamarin{}.
\item\textbf{ Inference Based Reveal Rule}. This is t0he key element of this approach, it encodes the "intuitive leap" required to connect the distribution of the auxiliary population with the encrypted dataset.   If  distribution of \aux{} matches \enc{} the rule will reveal the plaintext value.
\missingfigure{Schematic diagram of reveal rule}
\item \textbf{Execution}
	- The \tamarin{} verier is executed with each of generated \aux{} populations. The results are graphed for analysis.
\end{enumerate}

\missingfigure{Schematic diagram of approach}
Procedural exploration of the permutations of the auxiliary dataset allows additional insights in to the particular situations where a protocol is secure or not.


As a control \todo[inline]{IDEA: Explore if 2 Value DET plus salt helps... i.e 2 values becomes 20 values... probably can be discounted as the salts need to be know by the client and hence will be known by the attacker. Might be interesting way of extending the model for exposition purposes.
There is a model of attacking things link ARX which involved having access to a complete backup of the database and applying a Cash like approach to infinitely querying it.
} 
\section{Case Studies on applying technique}
\todo[inline]{1500}
\subsection{Attackking 2-value Determinstic Encryption}
Deterministic encryption always encodes the same value the same way. It is well known that it is vulnerable to frequency analysis and it has been used since the 9th century\cite{Arab} for breaking classical  encryption techniques.
\todo[inline]{Why atttack DET? We know it is insecure. Is DET used? HAshing is a form of DET and is commonly used. When used withour proper its vulnerable. (Could model this handily?) }

A. The DET/2 protocol is encode as two pairs of rules:
	DEnc('1') -> X
	DEnc('0') -> Y
	DDec(X) ->  DEnc('1')
	DDec(Y) ->  DEnc('0')
	The actual X and Y values are determined by the setup phase are and do not affect the proof.
	When DEnc is executed the appropriate counters are also incremented. Tamarin multisets are used as a base-1 counter (i.e 'X'+'X'+'X'+'X'+'X' = 5).
B. The Aux population is encoded as a multiset with 2 values. (e.g 1' + '1' + '1' + '1' + '1' + '1' + '0' + '0' + '0' + '0' representing a 60/40 split). Tamarin multisets are not ordered. ('0'+'0'+'1' is equal to '1'+'0'+'0'). To keep run-times low the aux population is limited to ten distinct binary values.
The population is varied as follows: 0/10\%, 10/90\% ..., 90/10\%, 100/0\%. 
Using the built in Observational Equivalence function diff(); Tamarin attempts to prove each model twice, once with the Aux population and once with a perfectly distributed set of values (i.e. 50/50\%). 
C. The inference rule reavels the encrypted value of X if the auxiliary population distribution uniquely matches the encrypted dataset population
D. When executing Tamarin will ex cute each model twice, if it can not distinguish between the two cases (50/50 and the one under test) then the proof is valid.
E. As a control the experiment is repeated using non-deterministic symmetric encryption with the expectation that the data is secure regardless of population distribution.

\subsection{Outline of proposed approch for 3 Value Det.}
A. Rules as above extended to 3 value (A,B,C)
B. Simlar as above
C. The inference rule is build uses the follwoing counters:
		Count of A, count of Not A
		Count of B, count of Not B
		Count of C, count of Not C
The insight being that Not A is equivlient to  [B,C] and we can solve for A first then solve for B, C as previouusly.



\textbf{Old notes on Methodology}
The insight is that we are not actually attack the storage protocol for the  "save" operation for the desired value. We are attacking the data at rest (as in Honest but Curious).
The only "super powers" the attacker has are being able to read all values (which we assume are encrypted) and being able to reason about the frequency analysis of the population.
We expect a hyothetical attack to look like:
\begin{itemize}
\item Client Stores values 
\item HbC Attacker reads values
\item HbC Attacker notices that the frequency distribution of a column is similar to that of the population.
\item HbC concludes with some degree of confidence what the  given value is. 
\end{itemize}

A bit more formally; need to model a distribution for the column, a distribution for the population and a confidence threshold.



Ideas on using observational equivalence.
If the system is secure we should not be able to reveal the value if we swap the distributions of the population with a ?normal? or ?random? or ?even? distribution. We can use the diff operator in Tamarin to accomplish this. 
diff(random distribution, actual population distribution) Note this approach only works if population and column distribution match. We can leverage early work that shows that they do in many cases. Diff operator is how tamarin models observational equivalence. 
If the population and colum distributions are 50/50 then there is no information. So what would an attack look like...
Consider an 80/20 distribution.

We need a "if" rule that reveals only if the population and column distribution is the same? This would seem to be a pretty weak attack model but would it lead to an approach that would work on more complex protocols like differental privacy etc?
\begin{itemize}
\item 
\item The rule would mean... if I have a 80/20 split in the data and an 80/20 split in the population, I am X\% confident that the 80 value in the sample is the 80 value in the population.
\item i.e we need to do some stats to figure out what the confience levels are
\item The tamarin rules would need to model
\item 1) The population distribution
\item 2) The reavel?
\end{itemize}

A security lemma should model the confidence levels .. i.e. the inverse. It is not possible that the distribution of the column matches the distribution of the population within a certain confidence threshold.

Idea
\textbf{If we had such an if rule it would be fairly trival to run tamarin repeatedly at different distributions an graph if secure/not
}
Read \cite{Ismal2012}



% % // B
% % Idea
% % We replace the normal Secret Action Fact and Lemma:
% % Secret(x) action occurs at timepoint i, the adversary does not know x.
% % lemma secrecy:
% % "All x #i.
% % Secret(x) @i ==> not (Ex #j. K(x)@j)"
% % With a probably action fact
% % PSecret(x,y)
% % And a lemma like
% % PSecret(x,y) @i ==> not (Ex #j. K(x)@j)"
% % 	and y<Threshold
% (This is where the problem comes in as Tamrin doesn't do < for non-temporal variables.
% well.. when using multiset we can construct numbers like 1+1+1 etc and create lemmas like GreaterThan and LessThan in the Manual. 


% Next Step, observationl equivelent for the 0/100 models
% Model
% Rule
% Population Distribution, Column Distribution, E(Value)
% -> Reveal Value if say(95%) match between Population and Column Distribution
% Setup phase
% A, Population 80/20
% B, Population 50/50

% active populaiton if diff(A,B)
% from /home/dbecker/git/tamarin-prover/examples/post17/foo/vote/privacy.spthy:
% rule setup:
%   [  ]
%   --[ OnlyOnce() ]->
%   [ Vote('v1', diff($yes, $no) ), Vote('v2', diff($no, $yes) ) ]

% so:



(Aside) One attack it would be useful to find  is if the attacker can fill the database with known values...








Another Insight
Maybe we can extend the equational theory
consider from
/home/dbecker/git/tamarin-prover/examples/ccs15/probEnc.spthy
	functions: penc/3, pdec/2, pk/1
	equations: pdec(penc(m,pk(k),r), k) = m
Also from manual
Tamarin also supports private function symbols. In contrast to regular function symbols, Tamarin
assumes that private function symbols cannot be applied by the adversary. Private functions can
be used to model functions that implicitly use some secret that is shared between all (honest) users.
To make a function private, simply add the attribute [private] after the function declaration. For
example, the line


penc(m,k, dP, dS)=E
where dP models the distribution of the variable in the popultaion and dS is the distribution in the sample.
pdec(E) = m

er... Can't see how to make this work.

May3rd 
determanistic encryption
functions:
denc/2, ddec/2
equations:
ddec(k, denc(k, m))=m

May3rd
Setup Rule
Store e('0'), e('0')
Generate value as diff('0','1') and store
Reveal Rule

Scenarios for boolean colum
Population 	Column 	Outcome
0/100		0/100	Reveal 100%
100/0		0/100	Reavel 100% but incorrectly
50/50		50/50	Secure; can not know
75/25		75/25	Reveal with some propoablity

% May 3rd INSIGHT
% Can use use Lemmas with counters?
% Ie test that counter A > counter B?
% This would allow us to check the relative occurances of 0/1
% from /home/dbecker/git/tamarin-prover/examples/features/multiset/counter.spthy
% lemma counter/increases[reuse,use/induction]:
%   "All x y #i #j s.
%       Counter(s,x) @ i & Counter(s,y) @ j ==> #i < #j
%       ==> Ex z. x + z = y"
% "For all x y and s at time points #i and #j 
% 	where theres exists a Counter(s, x) at # i and a counter (s,y) at #j; and  #i is before #j; there exists a z such that x + z=y. (i.e.  y>z)

% Soooo....
% For all Counter0(s,x), Counter0(s,y), Counter1(s,a), Counter1(s,b), at #i #j #k #l; and #i is before #j and #k is before #l there exists z,c,d  such such that 
% x+z=y and a+c=b
% AND
% (this is the important bit)  x+d=a (i.e. a>x)

% [This seems possible but what does it get us...]

% Can we use this to construct a lemma about probablist reveals? and the attack would construct a database where the distribution is skewed to reveal?
% So the attack might look like a hitting the '1' counter more often that the '0' counter.
% The next triky bit will be encoding the threshold
% perhaps we can use multiplaction by addition to generate a suitable value
% i.e x+x+y=z ... z is at least x*2  
% Need to test id this works...
% May 5th
% Ok this works see /home/dbecker/git/April19Paper/models/DoubleCounters.spthy
% In principle we can construct any ratio using this technique

% Next step
% Recap where this gets us...
% So we can insert into a database with an specified ratio of 0 and 1 that are DET encrypted
% We could also model a population with a specified ratio. 
% The bit missing is the attack :-(

% We could have a lemma that encodes the attack threshold
% I.e it can not be that the ratios of the database and the population are sufficently similar 
% The found attack will consist of populating the database.. to match a fixed population
% Let's take the threshold value from \cite{inference}
% hmm... they just use "Sex. Sex can be either male or female. The most prominent feature of the sex attribute is that most hospitals have more female patients than male patients. This is possibly due to pregnancy, births, and the fact that women live longer. Sex is universally used in all databases that store information about people.
% •"

% so consider a 60:40 0/1 population... with database with a similar ratio we can just declare that the value of the 60% is 0
% We can use lemmas to restrict the auxillary population "construction" to the desired ratio i.e. x+x+x=y+y
% Consider 4 counters
% Counter/AUX/0, Counter/AUX/1, Counter/DB/A, Counter/DB/B
% shorter: X0, X1, A, B
% A valid attack should only be found if XO:X1 == A:B i.e they are in the same ratio.
% or more simpler X0 == A

But ideally we want a rule that outputs a '0' or '1' and proves and attack rather than just asserts the database distribution matches the population distribution
IDEA: Could we use hashing of multiset values as an alternative to strict counting?
IDEA: Can we add a length funtion to use on multiset?
IDEA: Can we use diff to trigger different ratios?
IDEA: write a new built in? (sounds hard)

Method: For a given auxiliary dataset, is there a provable insecure database?  
Proving utility by "fixing" DET by adding a salt

\section{Contribution}

A formal model and validation to attack deterministic encryption. This model can be used as a basis for research into attacking other Property Preserving techniques.
1/ What is the hypothesis?
2/ What is the approach and has this approach be done before?
3/ Who cares? Why?
		Add citations for model bits that came from other papers to should continuation from existing research. 

\subsection{Future Work}
Future work areas include generalising this technique and exploring adding inference rules automatically to existing symbolic models to extend the applicability of the technique.

Motivation/Future work: Extend to hashing attacks? 	We only consider exact matches, the reveal rule could be extended to have fuzzier definition.
	Generalise proofs rather than relying on brute force.
\todo[inline]{Re-run using different Tamarin heuristic models to see if performance ca be improved. This is likely just stretching out the data but no real insights.
}
\todo[inline]{That bit about more numbers starting with 1 that other numbers (is there a reference for this)
}
\todo[inline]{
 Consider how a  ℓₚ approach would work in Tamarin? very difficult with out maths.... Could perhaps use python to generate a bunch of rules?
}
\todo[inline]{ What remains unresolved? 
	The Tamarin tool could be extended to have the means to vary an Auxiliary population baked in to it. Other protocols could be explored; ARX for example or ORAMS. The statisical significance work has not been undertaking; we've merely declared some threshold exists.

}
\section{Conclusion}
\todo[inline]{200 words}
This novel approach of injecting a auxiliary population and inference rule into a symbolic verification model has proved feasible for some scenarios. 




% if have a single appendix:
%\appendix[Proof of the Zonklar Equations]
% or
%\appendix  % for no appendix heading
% do not use \section anymore after \appendix, only \section*
% is possibly needed

% use appendices with more than one appendix
% then use \section to start each appendix
% you must declare a \section before using any
% \subsection or using \label (\appendices by itself
% starts a section numbered zero.)
%


\appendices
\section{Code Listing}
\lstinputlisting[language=Tamarmin]{models/AttackingDET_6040.spthy}





% use section* for acknowledgment
\section*{Acknowledgment}


The authors would like to thank...


% Can use something like this to put references on a page
% by themselves when using endfloat and the captionsoff option.
\ifCLASSOPTIONcaptionsoff
  \newpage
\fi
\todo[inline]{
Browns 8 Questions:
1. Who are intended readers? (3-5 names) 
Someone like Cas Cremer from the the tamarin world
Charles V Wright from the inference paper (and helped with the SoK paper)
Someone like Popa or other protocol developer

2. What did you do? (50 words)
	1. Developed a set of machine verifiable symbolic models encompassing a property preserving encryption protocol, auxiallary population and set of security properties to be verified.
		The model includes a specification for the attacker model and an new inference rule.
	2. Verifiy the model using Tamarin with a set of auxiallry populations where the distribution is varied.

3. Why did you do it? (50 words)
	Encryption protocols are hard to get right. Extending the symbolical model to include inference attacks extends the capablities of the tooling and allows additional attack vectors to be found. This work does not seek to generate new attack models but to automated the discovery tof potential attacks in proofs.
4. What happened? (50 words)
	The tooling was sucessfully extended to interate over multiple auxially populations deomonstrating the importance of introducing auxially data in to models and the viablity of the approach. The results on theritical models match well with emperical results previsouly pubished in /cite{inference}. The code used in the approach was published to allow others to extend on this work.
5. What do results mean in theory? (50 words)
	This approcah extends the the applicaplity of formal validation of cryptographic protocols. It clearly highlights some boundaries for using PPE techniques. (TODO: Does this mean we can say never use DET if less that N distinct values?). 

6. What do results mean in practice? (50 words)
	Symobolical verification can be used for a broader range of protocols; certain prtocols should not be used execept in very carefully controlled enviroments. Auxiallry populations are very powerful.
7. What is the key benefit for readers (25 words)
	The reader understands how the availablity and use of an auxiallry populations adds an attacker. How symbolical verification with an auxiallry population can reveal additional attack vectors. 
8. What remains unresolved? (no word limit) 
	The Tamarin tool could be extended to have the means to vary an Auxiary population baked in to it. Other protocols could be explored; ARX for example or ORAMS. The statisical signaficance work has not been undertaking; we've merely declared some threshold exists.


 

}


% trigger a \newpage just before the given reference
% number - used to balance the columns on the last page
% adjust value as needed - may need to be readjusted if
% the document is modified later
%\IEEEtriggeratref{8}
% The "triggered" command can be changed if desired:
%\IEEEtriggercmd{\enlargethispage{-5in}}

% references section

% can use a bibliography generated by BibTeX as a .bbl file
% BibTeX documentation can be easily obtained at:
% http://mirror.ctan.org/biblio/bibtex/contrib/doc/
% The IEEEtran BibTeX style support page is at:
% http://www.michaelshell.org/tex/ieeetran/bibtex/
%\bibliographystyle{IEEEtran}
% argument is your BibTeX string definitions and bibliography database(s)
%\bibliography{IEEEabrv,../bib/paper}
%
% <OR> manually copy in the resultant .bbl file
% set second argument of \begin to the number of references
% (used to reserve space for the reference number labels box)

\bibliographystyle{IEEEtran}
\bibliography{bibtex/references}


% biography section
% 
% If you have an EPS/PDF photo (graphicx package needed) extra braces are
% needed around the contents of the optional argument to biography to prevent
% the LaTeX parser from getting confused when it sees the complicated
% \includegraphics command within an optional argument. (You could create
% your own custom macro containing the \includegraphics command to make things
% simpler here.)
%\begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{mshell}}]{Michael Shell}
% or if you just want to reserve a space for a photo:

% \begin{IEEEbiography}{Michael Shell}
% Biography text here.
% \end{IEEEbiography}

% % if you will not have a photo at all:
% \begin{IEEEbiographynophoto}{John Doe}
% Biography text here.
% \end{IEEEbiographynophoto}

% % insert where needed to balance the two columns on the last page with
% % biographies
% %\newpage

% \begin{IEEEbiographynophoto}{Jane Doe}
% Biography text here.
% \end{IEEEbiographynophoto}

% You can push biographies down or up by placing
% a \vfill before or after them. The appropriate
% use of \vfill depends on what kind of text is
% on the last page and whether or not the columns
% are being equalized.

%\vfill

% Can be used to pull up biographies so that the bottom of the last one
% is flush with the other column.
%\enlargethispage{-5in}



% that's all folks

\end{document}


